machine:
  pre:
    - sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 3FA7E0328081BFF6A14DA29AA6A19B38D3D831EF
    - echo "deb http://download.mono-project.com/repo/debian wheezy main" > /etc/apt/sources.list.d/mono-xamarin.list
    - apt-get update -qq
    - apt-get install -y --no-install-recommends mono-complete  
    - curl -sSL https://raw.githubusercontent.com/aspnet/Home/dev/dnvminstall.sh | DNX_BRANCH=dev sh 
    - source ~/.dnx/dnvm/dnvm.sh
    - dnvm upgrade -r coreclr
    - dnvm upgrade -r mono

  node:
    version: 5.3.0
  
dependencies:
  post:
    - npm install -g dredd
    - dnu restore
    - dnu publish
    - export PATH=$PATH:$(pwd)+"/bin/output/approot/dredd-hooks-dotnet"
    
test:
  override:
    - cd dredd-hooks-test && bundle install && bundle exec cucumber
